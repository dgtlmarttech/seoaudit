import React from 'react';

const URLVulnerability = ({ result: rawResult }) => { // Destructure result and rename to rawResult
  try {
    if (!rawResult || !rawResult.result || !Array.isArray(rawResult.result)) {
      return (
        <div className="min-h-screen bg-gray-100 p-6 font-sans antialiased flex flex-col items-center justify-center">
          <div className="bg-white rounded-lg shadow-xl p-8 max-w-md w-full text-center">
            <p className="text-lg text-gray-700">No data available to display for URL Vulnerability report.</p>
          </div>
        </div>
      );
    }

    const result = rawResult.result;

    const isSuccess = result.every(data => data.isValid);

    // Common Tailwind classes for table and its elements
    const tableClasses = "min-w-full bg-white border border-gray-300 rounded-md overflow-hidden shadow-sm";
    const thClasses = "py-3 px-4 bg-gray-200 font-semibold text-gray-700 border-b border-r text-left";
    const tdClasses = "py-2 px-4 text-gray-800 border-b border-r break-words";
    const sectionHeadingClasses = "text-2xl font-semibold text-gray-700 mb-4 border-b pb-2";
    const outputStatusClasses = (isSuccess) =>
      `inline-block px-3 py-1 rounded-full text-sm font-medium ${
        isSuccess ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
      }`;

    return (
      <div className="min-h-screen bg-gray-100 p-6 font-sans antialiased flex flex-col items-center justify-center">
        <div className="bg-white rounded-lg shadow-xl p-8 max-w-4xl w-full">
          <h2 className="text-3xl font-bold text-gray-800 mb-6 text-center">URL Vulnerability Report</h2>
          
          <div className="mb-10 p-6 border border-gray-200 rounded-lg bg-gray-50">
            <h3 className={sectionHeadingClasses}>Alternate Links</h3>
            <table className={tableClasses}>
              <thead>
                <tr>
                  <th className={thClasses}>S.No</th>
                  <th className={thClasses}>Link</th>
                  <th className={thClasses}>In Lowercase</th>
                  <th className={thClasses}>No Underscores</th>
                  <th className={thClasses}>No Duplicate Slashes</th>
                </tr>
              </thead>
              <tbody>
                {result.length > 0 ? (
                  result.map((data, index) => (
                    <tr key={index}>
                      <td className={tdClasses}>{index + 1}</td>
                      <td className={tdClasses}>
                        <a href={data.link} target="_blank" rel="noopener noreferrer" className="text-blue-600 hover:underline">
                          {data.link}
                        </a>
                      </td>
                      <td className={`${tdClasses} text-center`}>
                        <span
                          className={outputStatusClasses(data.isLowerCase === '&#10003;')}
                          dangerouslySetInnerHTML={{ __html: data.isLowerCase }}
                        />
                      </td>
                      <td className={`${tdClasses} text-center`}>
                        <span
                          className={outputStatusClasses(data.hasUnderscores === '&#10003;')}
                          dangerouslySetInnerHTML={{ __html: data.hasUnderscores }}
                        />
                      </td>
                      <td className={`${tdClasses} text-center`}>
                        <span
                          className={outputStatusClasses(data.hasDuplicateSlashes === '&#10003;')}
                          dangerouslySetInnerHTML={{ __html: data.hasDuplicateSlashes }}
                        />
                      </td>
                    </tr>
                  ))
                ) : (
                  <tr>
                    <td colSpan="5" className={`${tdClasses} text-center text-gray-500`}>No URL vulnerability data found.</td>
                  </tr>
                )}
              </tbody>
            </table>

            <h3 className="text-xl font-semibold text-gray-700 mb-3 mt-6">Output</h3>
            <table className={tableClasses}>
              <tbody>
                <tr>
                  <td className={thClasses}><strong>Status</strong></td>
                  <td className={tdClasses}>
                    <p className={outputStatusClasses(isSuccess)}>
                      {isSuccess ? 'Success' : 'Failure'}
                    </p>
                  </td>
                </tr>
                <tr>
                  <td className={thClasses}><strong>Report</strong></td>
                  <td className={tdClasses}>
                    {isSuccess
                      ? "All URLs are optimized, incorporating hyphens, lowercase letters, avoiding double slashes, and eliminating underscores to improve search engine visibility."
                      : "Incomplete SEO optimization detected. Enhance URLs by incorporating hyphens, lowercase letters, avoiding double slashes, and eliminating underscores to improve search engine visibility."}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    );
  } catch (error) {
    return (
      <div className="min-h-screen bg-red-50 text-red-800 p-6 font-sans antialiased flex flex-col items-center justify-center">
        <div className="bg-white rounded-lg shadow-xl p-8 max-w-md w-full text-center">
          <h2 className="text-3xl font-bold mb-4">Error</h2>
          <p className="text-lg">{error.message || 'An unexpected error occurred.'}</p>
        </div>
      </div>
    );
  }
};

export default URLVulnerability;
